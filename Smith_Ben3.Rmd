---
title: "in class 3"
author: "Benjamin Smith"
date: "9/25/2019"
output: pdf_document
---

```{r }
require(MASS)

p=1000
n=200
rho=0.5

Sigma <- matrix(nrow=p, ncol = p, NA) 

diag(Sigma) <- 1

Sigma[which(is.na(Sigma))] <- rho

X <- mvrnorm(n=n, mu = rep(0,p), Sigma = Sigma)

e <- rnorm(n)

Y <- 5*X[,1] + 5*X[,2] + 5*X[,3] + e

beta <- matrix(ncol=p, nrow = 100, NA)
RANK <- matrix(ncol = p, nrow = 100)


for (j in 1:100){
  set.seed(12345+j)
  X <- mvrnorm(n=n, mu = rep(0,p), Sigma = Sigma)
  e <- rnorm(n)
  Y <- 5*X[,1] + 5*X[,2] + 5*X[,3] + e
  for (i in 1:p){
    beta[j,i] <- abs(lm(Y~X[,i])$coef)[2]
  }
    #print(j)
    RANK[j,] <- rank(-beta[j,])
}

#head(t(RANK),5)

apply(RANK,2,mean)[1:10]

```
